require('@babel/polyfill');
const supertest = require('supertest');
const mongoose = require('mongoose');
const app = require('../index');

const request = supertest(app);
describe('Server Test Suite', () => {
  it('should handle a GET request to /api/reviews', async (done) => {
    const res = await request.get('/api/reviews');
    expect(res.body).toHaveLength(100);
    expect(res.status).toBe(200);
    done();
  });

  it('should handle a GET request for one listing from /api/reviews/5', async (done) => {
    const res = await request.get('/api/reviews/5');
    expect(res.body.listing_id).toBe(5);
    expect(res.status).toBe(200);
    done();
  });

  afterAll(async (done) => {
    mongoose.disconnect();
    done();
  });
});
